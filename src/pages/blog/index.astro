---
import Layout from "../../layouts/Layout.astro";
import BlogPostCard from "../../components/BlogPostCard.astro";
import { processAstroBlogPost, sortPostsByDate } from "../../lib/blog-utils";

// Get all blog posts from the blog directory
const allPosts = await Astro.glob("./*.md");

// Transform and sort posts
const blogPosts = allPosts.map(processAstroBlogPost);
const sortedPosts = sortPostsByDate(blogPosts);
---

<Layout title="Blog - Daniel Madeley">
    <div class="max-w-4xl mx-auto">
        <header class="mb-12">
            <h1 class="text-4xl font-bold text-stone-100 mb-4">Blog</h1>
            <p class="text-xl text-stone-400">
                Thoughts on design, development, and the intersection of
                technology and creativity.
            </p>
        </header>

        <div class="grid gap-8">
            {
                sortedPosts.map((post) => (
                    <BlogPostCard post={post} variant="default" />
                ))
            }
        </div>

        {
            sortedPosts.length === 0 && (
                <div class="text-center py-12">
                    <p class="text-stone-400 text-lg">
                        No blog posts yet. Check back soon!
                    </p>
                </div>
            )
        }
    </div>
</Layout>
